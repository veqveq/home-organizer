<div *ngIf="dictionary">
  <h1 class="text-center font-bold text-lg mb-4">Справочник: "{{dictionary.name}}"</h1>
  <p
    [ngClass]="!dictionary.description?'italic':''"
    class="text-center mb-6">{{dictionary.description ? dictionary.description : 'Описание не добавлено'}}</p>
  <hr class="mb-6"/>

  <table class="w-full">
    <tr>
      <td *ngFor="let field of dictionary.fields;"
          class="px-4 py-2 border text-center font-bold text-white"
          [ngClass]="field.unique && field.required
          ?'bg-gradient-to-l from-amber-600 to-red-600'
          :field.required
            ?'bg-amber-600'
            :field.unique
              ?'bg-red-600'
              :'bg-blue-600'">
        {{field.name}}</td>
    </tr>
    <tr
      class="group transition ease-in-out hover:scale-110 flex-row hover:bg-blue-3 hover:cursor-pointer odd:bg-white even:bg-slate-50"
      *ngFor="let item of items">
      <td *ngFor="let field of dictionary.fields"
          (click)="itemEditor.existedItem = item; updateModal.open()"
          class="group-hover:bg-blue-300 table-data px-4 py-2 border text-center grow transition ease-in-out duration-300"
          [ngClass]="[field.required?'font-bold':'',field.unique?'italic':'']">
        <span *ngIf="field.type != 'Boolean'">
        {{getValue(field, item)}}
        </span>
        <input *ngIf="field.type == 'Boolean'" type="checkbox" disabled [checked]="getValue(field,item)"/>
      </td>
      <td class=" bg-white">
        <button
          (click)="delete(item.id)"
          class="group-hover:opacity-100 opacity-0 transition ease-in-out duration-300 btn px-2 py-2 bg-red-600 rounded-r-2xl text-white text-xl font-bold hover:bg-red-300">
          &times;
        </button>
      </td>
    </tr>

    <button
      (click)="createModal.open()"
      class="w-[60px] h-[60px] font-bold rounded-full bg-red-700 text-white fixed right-5 bottom-5 py-4 px-4 hover:bg-red-300">
      +
    </button>

  </table>

  <p *ngIf="items && items.length==0">Нет записей</p>
</div>

<app-modal #createModal title="Новая запись в справочнике '{{dictionary.name}}'">
  <app-dictionary-item-editor
    [visible$]="createModal.visible$"
    [page]="this"
  ></app-dictionary-item-editor>
</app-modal>

<app-modal #updateModal title="Изменение записи в справочнике '{{dictionary.name}}'">
  <app-dictionary-item-editor #itemEditor
                              [visible$]="updateModal.visible$"
                              [page]="this"
  ></app-dictionary-item-editor>
</app-modal>
